<Window x:Class="SimpleBinaryVCS.View.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:SimpleBinaryVCS.View"
        mc:Ignorable="d"
        Title="MainWindow" Height="750" Width="1000">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height = "1*" />
            <RowDefinition Height = "9*" />
        </Grid.RowDefinitions>
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="3*"/>
                <ColumnDefinition Width="3*"/>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="2*"/>
            </Grid.ColumnDefinitions>
            <Grid Grid.Column="0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="3*"/>
                    <RowDefinition Height="4*"/>
                    <RowDefinition Height="3*"/>
                </Grid.RowDefinitions>

                <StackPanel 
                Grid.Row="0"
                Orientation="Vertical"
                >
                    <Label
                    Height="Auto"
                    VerticalAlignment="Top"
                    x:Name="updaterTag"
                    Content = "Updater">
                    </Label>
                    <TextBox
                    Height="Auto"
                    TextWrapping="Wrap"
                    VerticalAlignment="Top"
                    x:Name="updaterName"
                    Text = "{Binding Path = BackupVM.UpdaterName}">
                    </TextBox>
                    <Label
                    Height="Auto"
                    VerticalAlignment="Top"
                    x:Name="updaterNameTag"
                    Content = "Update Log">
                    </Label>
                    <TextBox
                        Height="Auto"
                        TextWrapping="Wrap"
                        x:Name="UpdateLog"
                        Text = "{Binding Path = BackupVM.UpdateLog}"
                        ScrollViewer.HorizontalScrollBarVisibility="Auto"
                        ScrollViewer.VerticalScrollBarVisibility="Auto"
                        ScrollViewer.CanContentScroll="True"
                    />
                </StackPanel>
                <DataGrid Grid.Row="1"
                    Name="BackupLog" 
                    ItemsSource='{Binding BackupVM.SelectedItem.ProjectFiles}'
                    BorderBrush="#cdcdcd"
                    ScrollViewer.CanContentScroll="True"
                    ScrollViewer.VerticalScrollBarVisibility="Auto"
                    ScrollViewer.HorizontalScrollBarVisibility="Auto"
                    CanUserAddRows="False"
                    CanUserDeleteRows="False"
                    AutoGenerateColumns="False"
                    >
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Filename" Binding="{Binding fileName}" Width ="2*"/>
                        <DataGridTextColumn Header="Version" Binding="{Binding deployedProjectVersion}" Width ="2*"/>
                        <DataGridTextColumn Header="Build Version" Binding="{Binding fileBuildVersion}" Width ="2*"/>
                        <DataGridTextColumn Header="Deployed Date" Binding="{Binding updatedTime}" Width ="3*"/>
                        <DataGridTextColumn Header="HashValue" Binding="{Binding fileHash}" Width ="1*"/>
                    </DataGrid.Columns>
                </DataGrid>
                <DataGrid Grid.Row="2"
                    Name="DiffLog" 
                    ItemsSource='{Binding BackupVM.SelectedItem.DiffLog}'
                    BorderBrush="#cdcdcd"
                    ScrollViewer.CanContentScroll="True"
                    ScrollViewer.VerticalScrollBarVisibility="Auto"
                    ScrollViewer.HorizontalScrollBarVisibility="Auto"
                    CanUserAddRows="False"
                    CanUserDeleteRows="False"
                    AutoGenerateColumns="False"
                    >
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Filename" Binding="{Binding fileName}" Width ="2*"/>
                        <DataGridTextColumn Header="Version" Binding="{Binding fileSrcPath}" Width ="2*"/>
                        <DataGridTextColumn Header="Build Version" Binding="{Binding fileBuildVersion}" Width ="2*"/>
                        <DataGridTextColumn Header="Changed Date" Binding="{Binding updatedTime}" Width ="3*"/>
                        <DataGridTextColumn Header="HashValue" Binding="{Binding fileHash}" Width ="1*"/>
                        <DataGridTemplateColumn Header="Restore">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Button Content="Restore" Command="{Binding DataContext.BackupVM.AddForRestore, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}"
                            CommandParameter="{Binding}" />
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                    <DataGrid.CellStyle>
                        <Style TargetType="DataGridCell">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding isNew}" Value="True">
                                    <Setter Property="Background">
                                        <Setter.Value>
                                            <SolidColorBrush Color="LightGreen" Opacity="0.5"/>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding isNew}" Value="False">
                                    <Setter Property="Background">
                                        <Setter.Value>
                                            <SolidColorBrush Color="PaleVioletRed" Opacity="0.5"/>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </DataGrid.CellStyle>
                </DataGrid>
            </Grid>
            <GridSplitter Grid.Column="0"
                          BorderThickness="1"
                          BorderBrush="Black"
                          />
            <StackPanel Grid.Column="1">
                <DataGrid
                    Name="backupList" 
                    ItemsSource="{Binding BackupVM.BackupProjectDataList}"
                    SelectedItem="{Binding BackupVM.SelectedItem}"
                    BorderBrush="#cdcdcd"
                    ScrollViewer.CanContentScroll="True"
                    ScrollViewer.VerticalScrollBarVisibility="Auto"
                    ScrollViewer.HorizontalScrollBarVisibility="Auto"
                    CanUserAddRows="False"
                    CanUserDeleteRows="False"
                    AutoGenerateColumns="False"
                    >
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Updater" Binding="{Binding updaterName}" Width ="2*"/>
                        <DataGridTextColumn Header="Version" Binding="{Binding updatedVersion}" Width ="3*"/>
                        <DataGridTextColumn Header="Deployed Date" Binding="{Binding updatedTime}" Width ="3*"/>
                        <DataGridTextColumn Header="Revision Number" Binding="{Binding revisionNumber}" Width ="1*"/>
                        <DataGridTextColumn Header="Changes" Binding="{Binding numberOfChanges}" Width ="1*"/>
                    </DataGrid.Columns>
                </DataGrid>
                <Button 
                        x:Name="RevertButton"
                        Content="Checkout"
                        Command="{Binding BackupVM.CheckoutBackup}"
                    />
            </StackPanel>

            <GridSplitter Grid.Column="1"
                    BorderThickness="1"
                    BorderBrush="Black"
                    />
            <DataGrid Grid.Column="2"
                Name="nextProjectVersionFileList" 
                ItemsSource='{Binding VcsVM.ProjectFiles}'
                BorderBrush="#cdcdcd"
                ScrollViewer.CanContentScroll="True"
                ScrollViewer.VerticalScrollBarVisibility="Auto"
                ScrollViewer.HorizontalScrollBarVisibility="Auto"
                CanUserAddRows="False"
                CanUserDeleteRows="False"
                AutoGenerateColumns="False"
                >
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Filename" Binding="{Binding fileName}" Width ="2*"/>
                    <DataGridTextColumn Header="Build Version" Binding="{Binding fileBuildVersion}" Width ="2*"/>
                    <DataGridTextColumn Header="Deployed PV" Binding="{Binding deployedProjectVersion}" Width ="2*"/>
                    <DataGridTextColumn Header="Deployed Date" Binding="{Binding updatedTime}" Width ="2*"/>
                    <DataGridTextColumn Header="Hash" Binding="{Binding fileHash}" Width ="3*"/>
                </DataGrid.Columns>
            </DataGrid>
            <GridSplitter Grid.Column="2"
              BorderThickness="1"
              BorderBrush="Black"
              />
            <Grid Grid.Column="3">
                <Grid.RowDefinitions>
                    <RowDefinition Height="2*"/>
                    <RowDefinition Height="5*"/>
                    <RowDefinition Height="3*"/>
                </Grid.RowDefinitions>
                <StackPanel Grid.Row="0">
                    <Label
                    Content="Updater"/>
                    <TextBox
                    Name="UpdaterNameInput"
                    Text="{Binding VcsVM.UpdaterName}"
                         />
                    <Label
                    Content="Update Log"/>
                    <TextBox
                    Name="DeployVersionInput"
                    TextWrapping="Wrap"
                    AcceptsReturn="True"
                    Text="{Binding VcsVM.UpdateLog}" Height="49"
                         />
                </StackPanel>
                <ListView Grid.Row="1"
                    Name="uploadWindow" 
                    MaxHeight="250"
                    ItemsSource='{Binding FileTrackVM.ChangedFileList}'
                    SelectedItem="{Binding FileTrackVM.SelectedItem, UpdateSourceTrigger=PropertyChanged}"
                    BorderBrush="#cdcdcd"
                    ScrollViewer.CanContentScroll="True"
                    ScrollViewer.VerticalScrollBarVisibility="Auto"
                    ScrollViewer.HorizontalScrollBarVisibility="Auto"
                    >
                    <ListView.View>
                        <GridView>
                            <GridViewColumn  Header="Name" DisplayMemberBinding="{Binding fileName}" Width ="Auto" />
                            <GridViewColumn  Header="Version" DisplayMemberBinding="{Binding fileBuildVersion}" Width ="Auto" />
                            <GridViewColumn  Header="FilePath" DisplayMemberBinding="{Binding fileRelPath}" Width ="Auto" />
                            <GridViewColumn  Header="Change Type" DisplayMemberBinding="{Binding fileChangedState}" Width ="Auto" />
                        </GridView>
                    </ListView.View>
                    <ListView.ItemContainerStyle>
                        <Style TargetType="ListViewItem">
                            <Setter Property="Background" Value="Transparent"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding fileChangedState}" Value="Added">
                                    <Setter Property="Background" Value="LightBlue"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding fileChangedState}" Value="Uploaded">
                                    <Setter Property="Background" Value="LightGoldenrodYellow"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding fileChangedState}" Value="Modified">
                                    <Setter Property="Background" Value="LightGreen"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding fileChangedState}" Value="Deleted">
                                    <Setter Property="Background" Value="LightCoral"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ListView.ItemContainerStyle>
                </ListView>
                <StackPanel Grid.Row="2">
                    <StackPanel Orientation="Vertical">
                        <!--#region --><!--<Button
                        x:Name="UploadButton"
                        Content="Upload Files" 
                        Height="20"
                        Margin="20, 5, 20, 0"
                        Command="{Binding FileTrackVM.ConductUpload}"
                        /> --><!--#endregion-->
                        <Button
                         x:Name="ClearButton"
                         Content="Clear New Files" 
                         Height="20"
                         Margin="20, 5, 20, 0"
                         Command="{Binding FileTrackVM.ClearNewfiles}"
                         />
                        <!--<Button
                         x:Name="RefreshButton"
                         Content="Refresh" 
                         Height="20"
                         Margin="20, 5, 20, 0"
                         Command="{Binding VcsVM.GetLocalChanges}"
                         />-->
                        <Button
                         x:Name="UpdateButton"
                         Content="Update" 
                         Height="20"
                         Margin="20, 5, 20, 0"
                         Command="{Binding VcsVM.ConductUpdate}"
                         />
                    </StackPanel>
                    <!--<StackPanel Orientation="Horizontal">
                        <Label Name="LocalChanges"
                               FontSize="9"
                               FontStyle="Italic"
                               Content="New Detected Local Changes"/>
                        <Label Name="LocalChangesInt"
                               FontSize="9"
                               Content="{Binding FileTrackVM.DetectedFileChange}"/>
                    </StackPanel>-->
                </StackPanel>
            </Grid>
        </Grid>
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="240*"/>
                <ColumnDefinition Width="240*"/>
                <ColumnDefinition Width="29*"/>
                <ColumnDefinition Width="291*"/>
            </Grid.ColumnDefinitions>
            <StackPanel Grid.Column="0" Orientation="Horizontal">
                <Button
                    x:Name="SetDeploySrcDirectory" 
                    HorizontalAlignment="Left"
                    Content="GetDeploySrcDir" 
                    Height="Auto" 
                    Command="{Binding VcsVM.GetDeploySrcDir}"
                    Width="Auto" />
                <Button
                    x:Name="GetProject" 
                    Content="GetProjectDir" 
                    HorizontalAlignment="Left"
                    Height="Auto" 
                    Command="{Binding VcsVM.GetProject}"
                    Width="Auto" />
                <Button
                    x:Name="FetchButton" 
                    Content="Fetch" 
                    HorizontalAlignment="Left"
                    Height="Auto" 
                    Command="{Binding BackupVM.FetchLogs}"
                    Width="Auto" />
                <Button
                    x:Name="FullLogButton" 
                    Content="Full Log" 
                    HorizontalAlignment="Right"
                    Height="Auto" 
                    Command="{Binding BackupVM.ViewFullLog}"
                    Width="Auto" />
            </StackPanel>
            <Button Grid.Column="1"
                x:Name="IntegrityCheckButton" 
                Content="Version Integrity Check" 
                HorizontalAlignment="Center"
                Height="Auto" 
                Command="{Binding FileTrackVM.CheckProjectIntegrity}"
                Width="Auto" />
            <!--<StackPanel  -->
            <!-- Grid.Column="1"                                                                              -->
            <!-- Orientation="Horizontal"                                                                     -->
            <!-- >                                                                                            -->
            <!-- <StackPanel Orientation="Vertical">                                                          -->
            <!-- <Label Name="DiskUsage" HorizontalAlignment="Center" Content="Disk Usage Rate" Width="Auto"/>-->
            <!-- <ProgressBar HorizontalAlignment="Center" Height="10" Width="100"/>                          -->
            <!-- </StackPanel>                                                                                -->
            <!--<Button                                                   -->
            <!--    Name ="IntegrityCheckButton"                          -->
            <!--    Content="Version Integrity Check"                     -->
            <!--    HorizontalAlignment="Right"                           -->
            <!--    Command="{Binding FileTrackVM.CheckProjectIntegrity}"/-->
            <!--</StackPanel>-->
            <StackPanel 
                Grid.Column="2"
                Orientation="Horizontal" Grid.ColumnSpan="2"
                >
                <Label Name="ProjectNameTag" Content="Project Name" Width="Auto"/>
                <Label Name="ProjectName" FontSize ="15" Content="{Binding VcsVM.ProjectName}" />
                <Label Name="CurrentVersionTag" Content="Current Version" Width="Auto"/>
                <Label Name="CurrentVersion" FontSize ="15" Content="{Binding VcsVM.CurrentVersion}" />
            </StackPanel>
        </Grid>
    </Grid>
</Window>